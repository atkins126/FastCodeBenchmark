unit StrLenDKCUnit;

interface

function StrLen_DKC_Pas_6_a(const Str: PChar): Cardinal;
function StrLen_DKC_Pas_6_b(const Str: PChar): Cardinal;
function StrLen_DKC_Pas_6_c(const Str: PChar): Cardinal;
function StrLen_DKC_Pas_6_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_1_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_1_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_1_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_1_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_2_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_2_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_2_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_2_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_3_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_3_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_3_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_3_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_4_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_4_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_4_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_4_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_5_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_5_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_5_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_5_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_6_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_6_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_6_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_6_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_7_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_7_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_7_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_7_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_8_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_8_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_8_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_8_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_9_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_9_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_9_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_9_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_10_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_10_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_10_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_10_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_18_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_18_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_18_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_18_d(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_19_a(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_19_b(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_19_c(const Str: PChar): Cardinal;
function StrLen_DKC_IA32_19_d(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_7_a(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_7_b(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_7_c(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_7_d(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_8_a(const Str: PChar): Cardinal;//+
function StrLen_DKC_MMX_8_b(const Str: PChar): Cardinal;//+
function StrLen_DKC_MMX_8_c(const Str: PChar): Cardinal;//+
function StrLen_DKC_MMX_8_d(const Str: PChar): Cardinal;//+
function StrLen_DKC_MMX_9_a(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_9_b(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_9_c(const Str: PChar): Cardinal;
function StrLen_DKC_MMX_9_d(const Str: PChar): Cardinal;
function StrLen_DKC_SSE2_1_a(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_1_b(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_1_c(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_1_d(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_4_a(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_4_b(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_4_c(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_4_d(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_5_a(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_5_b(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_5_c(const Str: PChar): Cardinal;//+
function StrLen_DKC_SSE2_5_d(const Str: PChar): Cardinal;//+

implementation

//Author:            Dennis Kjaer Christensen
//Date:              28/11 2005
//Instructionset(s): IA32

function StrLen_DKC_Pas_6_a(const Str: PChar): Cardinal;
var
 S : PChar;

begin
 S := Str;
 Result := 0;
 if S^ = #0 then
  Exit;
 repeat
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
 until(S^ = #0);
end;

procedure Filler9;
asm
 nop
end;

function StrLen_DKC_Pas_6_b(const Str: PChar): Cardinal;
var
 S : PChar;

begin
 S := Str;
 Result := 0;
 if S^ = #0 then
  Exit;
 repeat
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
 until(S^ = #0);
end;

procedure Filler10;
asm
 nop
end;

function StrLen_DKC_Pas_6_c(const Str: PChar): Cardinal;
var
 S : PChar;

begin
 S := Str;
 Result := 0;
 if S^ = #0 then
  Exit;
 repeat
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
 until(S^ = #0);
end;

procedure Filler11;
asm
 nop
end;

function StrLen_DKC_Pas_6_d(const Str: PChar): Cardinal;
var
 S : PChar;

begin
 S := Str;
 Result := 0;
 if S^ = #0 then
  Exit;
 repeat
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
  if S^ = #0 then
   Exit;
  Inc(S);
  Inc(Result);
 until(S^ = #0);
end;


//Author:            Dennis Kjaer Christensen
//Date:              27/11 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_1_a(const Str: PChar): Cardinal;
asm
   //Result := 0;
   xor edx,edx
   //if S^ = #0 then
   cmp byte ptr [eax],$00
   jz @Exit
 @LoopStart :
   //Inc(S);
   inc eax
   //Inc(Result);
   inc edx
   //until(S^ = #0);
   cmp byte ptr [eax],$00
   jnz @LoopStart
 @Exit :
   mov eax,edx
end;

function StrLen_DKC_IA32_1_b(const Str: PChar): Cardinal;
asm
   //Result := 0;
   xor edx,edx
   //if S^ = #0 then
   cmp byte ptr [eax],$00
   jz @Exit
 @LoopStart :
   //Inc(S);
   inc eax
   //Inc(Result);
   inc edx
   //until(S^ = #0);
   cmp byte ptr [eax],$00
   jnz @LoopStart
 @Exit :
   mov eax,edx
end;

function StrLen_DKC_IA32_1_c(const Str: PChar): Cardinal;
asm
   //Result := 0;
   xor edx,edx
   //if S^ = #0 then
   cmp byte ptr [eax],$00
   jz @Exit
 @LoopStart :
   //Inc(S);
   inc eax
   //Inc(Result);
   inc edx
   //until(S^ = #0);
   cmp byte ptr [eax],$00
   jnz @LoopStart
 @Exit :
   mov eax,edx
end;

function StrLen_DKC_IA32_1_d(const Str: PChar): Cardinal;
asm
   //Result := 0;
   xor edx,edx
   //if S^ = #0 then
   cmp byte ptr [eax],$00
   jz @Exit
 @LoopStart :
   //Inc(S);
   inc eax
   //Inc(Result);
   inc edx
   //until(S^ = #0);
   cmp byte ptr [eax],$00
   jnz @LoopStart
 @Exit :
   mov eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_2_a(const Str: PChar): Cardinal;
asm
   xor   edx,edx
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   mov   eax,edx
end;

function StrLen_DKC_IA32_2_b(const Str: PChar): Cardinal;
asm
   xor   edx,edx
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   mov   eax,edx
end;

procedure Filler22;
asm
 nop
end;

function StrLen_DKC_IA32_2_c(const Str: PChar): Cardinal;
asm
   xor   edx,edx
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   mov   eax,edx
end;

function StrLen_DKC_IA32_2_d(const Str: PChar): Cardinal;
asm
   xor   edx,edx
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   mov   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_3_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   eax,eax
   movzx ecx,[edx]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[edx]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
end;

function StrLen_DKC_IA32_3_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   eax,eax
   movzx ecx,[edx]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[edx]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
end;

procedure Filler23;
asm
 nop
end;

function StrLen_DKC_IA32_3_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   eax,eax
   movzx ecx,[edx]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[edx]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
end;

function StrLen_DKC_IA32_3_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   eax,eax
   movzx ecx,[edx]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   inc   edx
   movzx ecx,[edx]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_4_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_4_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_4_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_4_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   movzx ecx,[eax]
   test  ecx,ecx
   jz    @Exit
 @LoopStart :
   inc   eax
   movzx ecx,[eax]
   test  ecx,ecx
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_5_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   inc   eax
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler24;
asm
 nop
end;

function StrLen_DKC_IA32_5_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   inc   eax
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler25;
asm
 nop
end;

function StrLen_DKC_IA32_5_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   inc   eax
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler26;
asm
 nop
end;

function StrLen_DKC_IA32_5_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   inc   eax
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_6_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_6_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_6_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_6_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl, byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl, byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_7_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_7_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_7_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_7_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_8_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler27;
asm
 nop
end;

function StrLen_DKC_IA32_8_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler28;
asm
 nop
end;

function StrLen_DKC_IA32_8_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler29;
asm
 nop
end;

function StrLen_DKC_IA32_8_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_9_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_9_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler30;
asm
 nop
end;

function StrLen_DKC_IA32_9_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_9_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              1/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_10_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler31;
asm
 nop
end;

function StrLen_DKC_IA32_10_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler32;
asm
 nop
end;

function StrLen_DKC_IA32_10_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

procedure Filler33;
asm
 nop
end;

function StrLen_DKC_IA32_10_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   ecx,ecx
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              4/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_18_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_18_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_18_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_18_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              7/12 2005
//Instructionset(s): IA32

function StrLen_DKC_IA32_19_a(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   nop
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
   nop
   nop
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_19_b(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   nop
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
   nop
   nop
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_19_c(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   nop
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
   nop
   nop
 @Exit :
   sub   eax,edx
end;

function StrLen_DKC_IA32_19_d(const Str: PChar): Cardinal;
asm
   mov   edx,eax
   xor   cl,cl
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   nop
 @LoopStart :
   add   eax,1
   cmp   cl,byte ptr [eax]
   jz    @Exit
   add   eax,1
   cmp   cl,byte ptr [eax]
   jnz   @LoopStart
   nop
   nop
 @Exit :
   sub   eax,edx
end;

//Author:            Dennis Kjaer Christensen
//Date:              2/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_1_a(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_1_b(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_1_c(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_1_d(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              2/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_2_a(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler38;
asm
 nop
end;

function StrLen_DKC_MMX_2_b(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler39;
asm
 nop
end;

function StrLen_DKC_MMX_2_c(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler40;
asm
 nop
end;

function StrLen_DKC_MMX_2_d(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              2/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_3_a(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_3_b(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_3_c(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_3_d(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   add      ebx,esi
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              2/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_4_a(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_4_b(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_4_c(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

function StrLen_DKC_MMX_4_d(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              3/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_5_a(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler41;
asm
 nop
end;

function StrLen_DKC_MMX_5_b(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler42;
asm
 nop
end;

function StrLen_DKC_MMX_5_c(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

procedure Filler43;
asm
 nop
end;

function StrLen_DKC_MMX_5_d(const Str: PChar): Cardinal;
asm
   push     ebx
   push     esi
   xor      esi,esi
   mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      ebx,eax
   and      ebx,7
   test     ebx,ebx
   jz       @Aligned
   sub      ebx,8
   neg      ebx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      ebx,1
   test     ebx,ebx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     ebx,mm1
   add      esi,8
   test     ebx,ebx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     bl, bl
   jnz      @Char1or2Match
   test     bh, bh
   jnz      @Char3or4Match
   shr      ebx, 16
   test     bl, bl
   jnz      @Char5or6Match
   test     bh, bh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      bl, 255
   je       @Char1Match
   cmp      bl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      bl, 255
   je       @Char3Match
   cmp      bh, 255
   je       @Char3Match
   cmp      bh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      bl, 255
   je       @Char5Match
   cmp      bl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      bl, 255
   je       @Char7Match
   cmp      bh, 255
   je       @Char7Match
   cmp      bh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   pop      ebx
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   pop      ebx
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   pop      ebx
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   pop      ebx
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   pop      ebx
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   pop      ebx
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   pop      ebx
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   pop      ebx
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              3/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_6_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   //mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_MMX_6_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   //mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

procedure Filler44;
asm
 nop
end;

function StrLen_DKC_MMX_6_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   //mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_MMX_6_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   //mov      edx,eax
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              4/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_7_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_MMX_7_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_MMX_7_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_MMX_7_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              5/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_8_a(const Str: PChar): Cardinal;
asm
   movzx    ecx,byte ptr [eax]
   test     cl,cl
   jz       @Exit0
   push     esi
   xor      esi,esi
   add      esi,1
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
   nop
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
   nop
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

function StrLen_DKC_MMX_8_b(const Str: PChar): Cardinal;
asm
   movzx    ecx,byte ptr [eax]
   test     cl,cl
   jz       @Exit0
   push     esi
   xor      esi,esi
   add      esi,1
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
   nop
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
   nop
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

function StrLen_DKC_MMX_8_c(const Str: PChar): Cardinal;
asm
   movzx    ecx,byte ptr [eax]
   test     cl,cl
   jz       @Exit0
   push     esi
   xor      esi,esi
   add      esi,1
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
   nop
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
   nop
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

function StrLen_DKC_MMX_8_d(const Str: PChar): Cardinal;
asm
   movzx    ecx,byte ptr [eax]
   test     cl,cl
   jz       @Exit0
   push     esi
   xor      esi,esi
   add      esi,1
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
   nop
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
   nop
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              6/12 2005
//Instructionset(s): IA32, MMX

function StrLen_DKC_MMX_9_a(const Str: PChar): Cardinal;
asm
   xor      cl,cl
   cmp      cl,byte ptr [eax]
   jz       @Exit0
   cmp      cl,byte ptr [eax+1]
   jz       @Exit1
   cmp      cl,byte ptr [eax+2]
   jz       @Exit2
   cmp      cl,byte ptr [eax+3]
   jz       @Exit3
   push     esi
   xor      esi,esi
   add      esi,4
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit1 :
   xor      eax,eax
   add      eax,1
   ret
 @Exit2 :
   xor      eax,eax
   add      eax,2
   ret
 @Exit3 :
   xor      eax,eax
   add      eax,3
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

function StrLen_DKC_MMX_9_b(const Str: PChar): Cardinal;
asm
   xor      cl,cl
   cmp      cl,byte ptr [eax]
   jz       @Exit0
   cmp      cl,byte ptr [eax+1]
   jz       @Exit1
   cmp      cl,byte ptr [eax+2]
   jz       @Exit2
   cmp      cl,byte ptr [eax+3]
   jz       @Exit3
   push     esi
   xor      esi,esi
   add      esi,4
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit1 :
   xor      eax,eax
   add      eax,1
   ret
 @Exit2 :
   xor      eax,eax
   add      eax,2
   ret
 @Exit3 :
   xor      eax,eax
   add      eax,3
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

procedure Filler1;
asm
 nop
end;

function StrLen_DKC_MMX_9_c(const Str: PChar): Cardinal;
asm
   xor      cl,cl
   cmp      cl,byte ptr [eax]
   jz       @Exit0
   cmp      cl,byte ptr [eax+1]
   jz       @Exit1
   cmp      cl,byte ptr [eax+2]
   jz       @Exit2
   cmp      cl,byte ptr [eax+3]
   jz       @Exit3
   push     esi
   xor      esi,esi
   add      esi,4
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit1 :
   xor      eax,eax
   add      eax,1
   ret
 @Exit2 :
   xor      eax,eax
   add      eax,2
   ret
 @Exit3 :
   xor      eax,eax
   add      eax,3
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

function StrLen_DKC_MMX_9_d(const Str: PChar): Cardinal;
asm
   xor      cl,cl
   cmp      cl,byte ptr [eax]
   jz       @Exit0
   cmp      cl,byte ptr [eax+1]
   jz       @Exit1
   cmp      cl,byte ptr [eax+2]
   jz       @Exit2
   cmp      cl,byte ptr [eax+3]
   jz       @Exit3
   push     esi
   xor      esi,esi
   add      esi,4
   mov      edx,eax
   add      edx,esi
   and      edx,7
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   movzx    ecx,byte ptr [eax+esi]
   add      esi,1
   test     cl,cl
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     mm0, mm0
 @LoopStart2 :
   movq     mm1,[eax+esi]
   pcmpeqb  mm1,mm0
   packsswb mm1,mm1
   movd     edx,mm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit0 :
   xor      eax,eax
   ret
 @Exit1 :
   xor      eax,eax
   add      eax,1
   ret
 @Exit2 :
   xor      eax,eax
   add      eax,2
   ret
 @Exit3 :
   xor      eax,eax
   add      eax,3
   ret
 @Exit :
   mov      eax,esi
   sub      eax,1
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              4/12 2005
//Instructionset(s): IA32, SSE2

function StrLen_DKC_SSE2_1_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

procedure Filler45;
asm
 nop
end;

function StrLen_DKC_SSE2_1_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

procedure Filler46;
asm
 nop
end;

function StrLen_DKC_SSE2_1_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

procedure Filler47;
asm
 nop
end;

function StrLen_DKC_SSE2_1_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              4/12 2005
//Instructionset(s): IA32, SSE2

function StrLen_DKC_SSE2_2_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_2_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_2_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_2_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   add      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              3/12 2005
//Instructionset(s): IA32, MMX, SSE, SSE2

function StrLen_DKC_SSE2_3_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movq     xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   packsswb xmm1,xmm1
   movd     edx,xmm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   //emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_3_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movq     xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   packsswb xmm1,xmm1
   movd     edx,xmm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   //emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_3_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movq     xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   packsswb xmm1,xmm1
   movd     edx,xmm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   //emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_3_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,7
   test     edx,edx
   jz       @Aligned
   sub      edx,8
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   test     edx,edx
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movq     xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   packsswb xmm1,xmm1
   movd     edx,xmm1
   add      esi,8
   test     edx,edx
   jz       @LoopStart2
   //emms
 @Found :
   //There is a match, but where? Find the leftmost match.
   test     dl, dl
   jnz      @Char1or2Match
   test     dh, dh
   jnz      @Char3or4Match
   shr      edx, 16
   test     dl, dl
   jnz      @Char5or6Match
   test     dh, dh
   jnz      @Char7or8Match
 @Char1or2Match :
   cmp      dl, 255
   je       @Char1Match
   cmp      dl, 127
   jbe      @Char1Match
   jmp      @Char2Match
 @Char3or4Match :
   cmp      dl, 255
   je       @Char3Match
   cmp      dh, 255
   je       @Char3Match
   cmp      dh, 127
   jbe      @Char3Match
   jmp      @Char4Match
 @Char5or6Match :
   cmp      dl, 255
   je       @Char5Match
   cmp      dl, 127
   jbe      @Char5Match
   jmp      @Char6Match
 @Char7or8Match :
   cmp      dl, 255
   je       @Char7Match
   cmp      dh, 255
   je       @Char7Match
   cmp      dh, 127
   jbe      @Char7Match
   jmp      @Char8Match
 @Char1Match :
   sub      esi,8
   mov      eax,esi
   pop      esi
   ret
 @Char2Match :
   sub      esi,8
   mov      eax,esi
   add      eax,1
   pop      esi
   ret
 @Char3Match :
   sub      esi,8
   mov      eax,esi
   add      eax,2
   pop      esi
   ret
 @Char4Match :
   sub      esi,8
   mov      eax,esi
   add      eax,3
   pop      esi
   ret
 @Char5Match :
   sub      esi,8
   mov      eax,esi
   add      eax,4
   pop      esi
   ret
 @Char6Match :
   sub      esi,8
   mov      eax,esi
   add      eax,5
   pop      esi
   ret
 @Char7Match :
   sub      esi,8
   mov      eax,esi
   add      eax,6
   pop      esi
   ret
 @Char8Match :
   sub      esi,8
   mov      eax,esi
   add      eax,7
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              5/12 2005
//Instructionset(s): IA32, SSE2

function StrLen_DKC_SSE2_4_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jnz      @Found
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_4_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jnz      @Found
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_4_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jnz      @Found
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_4_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   test     edx,edx
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jz       @Aligned
   jmp      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jnz      @Found
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

//Author:            Dennis Kjaer Christensen
//Date:              5/12 2005
//Instructionset(s): IA32, SSE2

function StrLen_DKC_SSE2_5_a(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_5_b(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_5_c(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

function StrLen_DKC_SSE2_5_d(const Str: PChar): Cardinal;
asm
   push     esi
   xor      esi,esi
   xor      ecx,ecx
   cmp      cl,byte ptr [eax]
   jz       @Exit
   mov      edx,eax
   and      edx,15
   jz       @Aligned
   sub      edx,16
   neg      edx
 @LoopStart :
   add      esi,1
   cmp      cl,byte ptr [eax+esi]
   jz       @Exit
   sub      edx,1
   jnz      @LoopStart
 @Aligned :
   pxor     xmm0,xmm0
 @LoopStart2 :
   movdqa   xmm1,[eax+esi]
   pcmpeqb  xmm1,xmm0
   pmovmskb edx, xmm1
   add      esi,16
   test     edx,edx
   jz       @LoopStart2
 @Found :
   //There is a match, but where? Find the leftmost match.
   sub      esi,16
   xor      eax,eax
   bsf      ax,dx
   add      eax,esi
   pop      esi
   ret
 @Exit :
   mov      eax,esi
   pop      esi
   ret
end;

initialization

 Filler1;
 Filler9;
 Filler10;
 Filler11;
 Filler22;
 Filler23;
 Filler24;
 Filler25;
 Filler26;
 Filler27;
 Filler28;
 Filler29;
 Filler30;
 Filler31;
 Filler32;
 Filler33;
 Filler38;
 Filler39;
 Filler40;
 Filler41;
 Filler42;
 Filler43;
 Filler44;
 Filler45;
 Filler46;
 Filler47;

end.


